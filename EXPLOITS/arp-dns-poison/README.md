    arp-and-dns-poisoning.md
    Show Name: Pentest+ (PT0-002)
    Topic Name: Attacks and Exploits
    Episode Name: ARP and DNS Poisoning

================================================================================
ARP and DNS Poisoning
Objectives:

    Define, explain, and demonstrate ARP and DNS poisoning attacks

    How does ARP work?
        Resolves IP to MAC
        Helps hosts find other hosts
            ARP Broadcasts
                Wireshark demo (Who has this IP? Tell this device)
            ARP Table
                Dynamic ARP
                arp -a

    Attacking ARP
        ARP Cache Poisoning or ARP Spoofing Attack
            Attacker can go after the switch
            Attacker can go after the host
                Threats
                    Sniffing
                    MitM
                    Session Hijacking
                    DoS

    ARP Poisoning Tools
        BetterCAP
        Ettercap - DEMO
            Run Wireshark from terminal first
                Then show how you can't see telnet login
            Now poison ARP with ettercap
                Then show how we can now view telnet login
        dsniff
        arpspoof

    DNS basics
        Resolve domains to IP
            Windows DNS Lookup order
                Checks self (am I the device I'm looking for?)
                Checks DNS Resolver Cache
                Checks the Hosts file (do I already know where this is?)
                Checks with DNS Servers

    DNS Attacks
        Modifying hosts DNS info
        Tricks hosts to query malicious DNS
            Host file entries
            Malicious proxy

    DNS cache poisoning
        Tricking clients into thinking that attacker is legit DNS
            Redirect targets to malicious sites
        DEMO: Ettercap for DNS poisoning
            Modify etter.dns file to have fake A records
            Copy from Kali /Tools/fakeArec.txt
            Change IP to match IP of bWAPP
            Run ettercap GUI
            Scan for hosts
            Add DNS server IP(192.168.241.1) to Target1
            Add victim IP(192.168.241.x) to Target2
            Ettercap Menu(3 dots) > Plugins > Manage Plugins > dns_spoof
            MITM menu > ARP Poisoning
            ping www.facebook.com from target
            ipconfig /displaydns
